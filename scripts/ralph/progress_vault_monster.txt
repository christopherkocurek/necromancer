# The Necromancer - Alpha 0.4.0 Progress Tracker
# Vault, Monster & XP System Rework
# Created: 2026-01-08
# PRD Version: 1.0

================================================================================
FILE FORMAT REFERENCE
================================================================================

## vault.txt Format

Location: lib/edit/vault.txt

### Header Lines:
- V:x.x.x        - Version stamp (required)
- # comments     - Documentation

### Vault Definition:
N:<id>:<name>                    - Vault ID and display name
X:<type>:<min_depth>:<rarity>    - Type, minimum depth, rarity (higher = rarer)
F:<flags>                        - Flags (optional, pipe-separated)
D:<row>                          - ASCII layout rows (one D: per row)

### Types:
- type 6  - Interesting room
- type 7  - Lesser vault
- type 8  - Greater vault
- type 9  - Sauron's vault
- type 10 - Gates of Dol Guldur (escape gauntlet)

### Flags:
- NO_ROTATION - Must not be rotated
- TRAPS       - Twice normal trap density
- WEBS        - 5% web chance per empty square
- LIGHT       - Permanently lit
- SURFACE     - Less common at depth

### Terrain Symbols:
$ - corridor connection    # - wall           % - quartz
: - rubble                 ; - protective rune
> - down stairs            < - up stairs
+ - door                   s - secret door
^ - trap                   0 - forge          7 - chasm
~ - poisoned water

### Monster/Item Symbols:
1-4 - monster +1 to +4 levels
* - treasure    & - good treasure    ? - monster and/or item
o - orc         O - orc captain      a - archer
b - flier       c - wolf             C - warg
M - spider      T - troll            z - undead
W - wight       w - shadow           v - vampire
@ - human enemy H - fell guardian

### Boss Symbols:
B - Broodmother           G - Gashnak, Warg-lord
K - Karvag the Torturer   L - Grishnakh, Crypt Lord
U - Uvatha the Horseman   N - Khamul
V - Sauron

--------------------------------------------------------------------------------

## monster.txt Format

Location: lib/edit/monster.txt

### Header Lines:
- V:x.x.x    - Version stamp (required)
- # comments - Documentation

### Monster Definition:
N:<id>:<name>                              - Monster ID and display name
W:<depth>:<rarity>                         - Native depth, rarity (1=common)
G:<symbol>:<color>                         - Display symbol and color
I:<speed>:<health_dice>:<light_radius>     - Speed, HP dice, light
A:<sleepiness>:<perception>:<stealth>:<will> - AI/defense stats
P:[<evasion>,<protection_dice>]            - Defense values
B:<method>:<effect>:(<bonus>,<damage_dice>) - Attack (multiple allowed)
S:<frequency> | <power>                    - Spell info
S:<spell_list>                             - Spell types (multiple S: lines)
F:<flags>                                  - Monster flags (multiple F: lines)
D:<text>                                   - Description

### Common Flags:
Behavioral: FRIENDS, ESCORT, ESCORTS, TERRITORIAL, RAND_25, RAND_50
Movement:   FLYING, PASS_WALL, PASS_DOOR, NEVER_MOVE, CHARGE, KNOCK_BACK
Combat:     SMART, FLANKING, NO_FEAR, REGENERATE
Doors:      OPEN_DOOR, BASH_DOOR, UNLOCK_DOOR
Drops:      DROP_33, DROP_100, DROP_GOOD, DROP_GREAT, DROP_1D2, DROP_3D2
Types:      ORC, TROLL, SPIDER, WOLF, SERPENT, UNDEAD, MAN, ELF
Resist:     RES_COLD, RES_POIS, RES_FIRE, RES_CRIT, HURT_LITE, HURT_FIRE, HURT_COLD
Mental:     MINDLESS, NO_CONF, NO_SLEEP
Special:    UNIQUE, QUESTOR, MALE, FEMALE, INVISIBLE, MULTIPLY, SPECIAL_GEN, PEACEFUL

### Attack Methods:
HIT, BITE, CLAW, TOUCH, PECK, ENGULF, WHIP, THORN

### Attack Effects:
HURT, POISON, WOUND, DARK, COLD, FIRE, BATTER
LOSE_STR, LOSE_DEX, LOSE_CON, LOSE_GRA, LOSE_ALL, LOSE_STR_CON
TERRIFY, CONFUSE, ENTRANCE, HALLU, DISARM, HUNGER

### Common Spells:
SHRIEK, ARROW1, DARKNESS, SLOW, SCARE, CONF, HOLD, DIM
HATCH_SPIDER, THROW_WEB, RALLY, SNG_BINDING, SNG_PIERCING

================================================================================
CURRENT STATE ANALYSIS
================================================================================

## vault.txt Summary

Total Vaults: 57

### By Numbering Range:
- N:1          - Gates of Dol Guldur (escape gauntlet)
- N:10-29      - Layer 1 vaults (20 vaults: 10-29)
- N:30-49      - Layer 2 vaults (16 vaults: 30-45)
- N:50-69      - Layer 3 vaults (15 vaults: 50-64)
- N:70-89      - Layer 4 vaults (13 vaults: 70-82)
- N:90-109     - Layer 5 vaults (11 vaults: 90-100)
- N:110-129    - Layer 6 vaults (9 vaults: 110-118)
- N:130-149    - Layer 7 vaults (4 vaults: 130-133)
- N:200-209    - Transition vaults (6 vaults: 200-205)
- N:450        - Sauron's Throne Room

### By Type:
- Type 6 (interesting room): ~45 vaults
- Type 7 (lesser vault): 8 vaults (boss lairs + transitions)
- Type 8 (greater vault): 1 vault (Khamul's Throne N:118)
- Type 9 (Sauron's vault): 1 vault (N:450)
- Type 10 (escape gauntlet): 1 vault (N:1)

### Layer Distribution:
Layer 1: 20 vaults (good coverage)
Layer 2: 16 vaults (good coverage)
Layer 3: 15 vaults (good coverage)
Layer 4: 13 vaults (adequate)
Layer 5: 11 vaults (could use more)
Layer 6: 9 vaults (light)
Layer 7: 4 vaults (minimal - appropriate for endgame)

### Boss Vaults:
- N:29  - Broodmother's Lair (Layer 1)
- N:45  - Gashnak's Den (Layer 2)
- N:64  - Karvag's Workshop (Layer 3)
- N:82  - Grishnakh's Domain (Layer 4)
- N:100 - Uvatha's Hall (Layer 5)
- N:118 - Khamul's Throne (Layer 6)
- N:450 - Sauron's Throne Room (Layer 7)

--------------------------------------------------------------------------------

## monster.txt Summary

Total Monsters: 67

### Special Entries:
- N:0-3   - Player graphics (4 entries)
- N:301-310 - Hallucinatory/special (10 entries)

### Combat Monsters by Layer:

**Layer 1 (Depths 1-3, 50-150ft):** 12 monsters
- N:11 Mirkwood Spider
- N:12 Giant Rat
- N:13 Black Squirrel (alarm)
- N:14 Crebain (alarm)
- N:15 Tanglethorn (static)
- N:16 Giant Bat (alarm)
- N:17 Web Spinner
- N:18 Orc Scout (alarm)
- N:19 Swamp Adder
- N:20 Great Spider
- N:21 Warg Pup
- N:22 Broodmother (BOSS)

**Layer 2 (Depths 3-6, 150-300ft):** 10 monsters
- N:31 Orc Slave
- N:32 Orc Soldier
- N:33 Orc Archer
- N:34 Warg
- N:35 Orc Thrallmaster
- N:36 Orc Captain
- N:37 Warg Rider
- N:38 Hill Troll
- N:39 Gashnak, Warg-lord (UNIQUE)
- N:40 Orc Warchief (BOSS)

**Layer 3 (Depths 6-9, 300-450ft):** 10 monsters
- N:51 Dark Acolyte
- N:52 Ghoul
- N:53 Mirk-troll
- N:54 Easterling Warrior
- N:55 Dark Sorcerer
- N:56 Tortured Wretch
- N:57 Easterling Champion
- N:58 Ghast
- N:59 Karvag the Torturer (UNIQUE)
- N:60 Master Sorcerer (BOSS)

**Layer 4 (Depths 9-12, 450-600ft):** 9 monsters
- N:71 Skeleton
- N:72 Skeleton Warrior
- N:73 Zombie
- N:74 Wight
- N:75 Corpse-candle
- N:76 Necromancer Adept
- N:77 Barrow-wight
- N:78 Bone Golem
- N:79 Grishnakh, Crypt Lord (UNIQUE/BOSS)

**Layer 5 (Depths 12-15, 600-750ft):** 10 monsters
- N:91 Phantom
- N:92 Shadow
- N:93 Whispering Shade
- N:94 Wraith
- N:95 Fell Spirit
- N:96 Spectre
- N:97 Vampire Thrall
- N:98 The Wailing Horror (UNIQUE)
- N:99 Uvatha the Horseman (BOSS)

**Layer 6 (Depths 15-18, 750-900ft):** 8 monsters
- N:111 Black Numenorean
- N:112 Olog-hai
- N:113 Vampire
- N:114 Greater Wraith
- N:115 Vampire Lord
- N:116 Shadow Lord
- N:117 Maia Thrall
- N:118 Khamul, Shadow of the East (BOSS)

**Layer 7 (Depths 18-20, 900-1000ft):** 5 monsters
- N:131 Elite Olog-hai
- N:132 Greater Shadow
- N:133 Void Wraith
- N:134 Thrain's Shade (peaceful objective)
- N:135 Sauron, the Necromancer (FINAL BOSS)

### Stealth-Relevant Analysis:

**Monsters with SLEEPING potential (high sleepiness):**
- Giant Bat (15), Warg (20), Warg Pup (20), Orc Slave (20)
- Vampire Thrall (20), Vampire (20), Vampire Lord (20)

**Alarm/Alert monsters (SHRIEK):**
- Black Squirrel, Crebain, Giant Bat, Orc Scout

**Pack monsters (FRIENDS/ESCORT/ESCORTS):**
Most orcs, wargs, skeletons, zombies, ghouls, phantoms, spectres

**Solo elites worth assassinating:**
- Orc Captain, Orc Thrallmaster, Dark Sorcerer
- Necromancer Adept, Barrow-wight, Wraith
- Black Numenorean, Vampire Lord, Shadow Lord

**Patrollers (TERRITORIAL):**
- Mirkwood Spider, Giant Rat, Black Squirrel, Tanglethorn
- Giant Bat, Web Spinner, Orc Thrallmaster
- Wight, Barrow-wight, Whispering Shade

================================================================================
TASK TRACKING
================================================================================

## Preparation Phase
[X] PREP-001: Create progress tracker and codebase patterns

## Vault Audit Phase
[ ] VAULT-001: Extract and catalog all vaults
[ ] VAULT-002: Tag vaults by layer appropriateness
[ ] VAULT-003: Audit vaults for stealth gameplay
[ ] VAULT-004: Flag boring/generic vaults

## Vault Design Phase
[ ] VAULT-005: Design Layer 1 vault themes
[ ] VAULT-006: Design Layer 2 vault themes
[ ] VAULT-007: Design Layer 3 vault themes
[ ] VAULT-008: Design Layer 4 vault themes
[ ] VAULT-009: Design Layer 5 vault themes
[ ] VAULT-010: Design Layer 6 vault themes
[ ] VAULT-011: Design Layer 7 vault themes

## Vault Implementation Phase
[ ] VAULT-012: Implement vault changes [COMMIT]

## Monster Audit Phase
[ ] MON-001: Extract and catalog all monsters
[ ] MON-002: Tag monsters by layer
[ ] MON-003: Audit monsters for stealth gameplay
[ ] MON-004: Identify missing monster archetypes

## Monster Design Phase
[ ] MON-005: Design new stealth-relevant monsters
[ ] MON-006: Prune generic filler monsters
[ ] MON-007: Propose monster modifications

## Monster Implementation Phase
[ ] MON-008: Implement monster changes [COMMIT]

## XP Research Phase
[ ] XP-001: Research roguelike XP alternatives
[ ] XP-002: Audit current SIL-Q XP system

## XP Design Phase
[ ] XP-003: Design Tower Objects system
[ ] XP-004: Design XP rebalance

## XP Implementation Phase
[ ] XP-005: Implement Tower Objects [COMMIT]
[ ] XP-006: Implement XP rebalance [COMMIT]

## Synthesis Phase
[ ] SYN-001: Cross-system stealth audit
[ ] SYN-002: Playtest archetype validation

## Finalization Phase
[ ] FINAL-001: Update GDD
[ ] FINAL-002: Write release notes
[ ] FINAL-003: Tag Alpha 0.4.0

================================================================================
LAYER REFERENCE (Quick Reference)
================================================================================

Layer | Name            | Depth (ft)  | Depth (lvl) | Theme
------|-----------------|-------------|-------------|---------------------------
1     | Forest Breach   | 50-150      | 1-3         | Spiders, poison, webs
2     | Orc Warrens     | 150-300     | 3-6         | Orcs, wargs, forges
3     | Torture Halls   | 300-450     | 6-9         | Sorcerers, ghouls, cells
4     | Necropolis      | 450-600     | 9-12        | Skeletons, wights, crypts
5     | Wraith Domain   | 600-750     | 12-15       | Phantoms, shadows, fear
6     | Inner Sanctum   | 750-900     | 15-18       | Black Numenoreans, Khamul
7     | Pits of Despair | 900-1000    | 18-20       | Sauron, Thrain, escape

================================================================================
DESIGN PRINCIPLES (from PRD)
================================================================================

1. STEALTH_FIRST: Every viable build invests in stealth. Infiltration is core.
2. LAYER_IDENTITY: Each layer should feel distinct in atmosphere, threats, tactics.
3. ASSASSINATION_REWARDING: Stealth kills feel powerful and efficient.
4. EXPLORATION_OVER_COMBAT: XP rewards discovery and objectives over grinding.
5. FEWER_BIGGER_MONSTERS: Vaults favor fewer, meaningful enemies over swarms.
6. TOLKIEN_GROUNDED: Third Age power scale. Aragorn-tier ceiling.

================================================================================
END OF PROGRESS TRACKER
================================================================================
